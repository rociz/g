<!DOCTYPE html>
<html>
<head>


<style>
html, body {
    max-width: 100%;
    overflow-y: hidden;
	overflow-x: hidden;

}
</style>


</head>
<body onclick= "clickFunc()" style="background-color:lightblue;">

<h1 style="color:white;" id="demo"></h1>


	
<canvas id="myCanvas" onload ="move()"  onkeydown="uniKeyCode(event)" width="800" height="400" style=" padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
	margin-top: 100px;
    display: block;border:3px solid white;">
</canvas>

<img id="grassland"  style="visibility:hidden" src="https://i.imgur.com/R06cI4d.png" alt="">

<audio id="myAudio">
  <source src="firstlevel.mp3" type="audio/mp3">
</audio>


<script>

var myVar = setInterval(move, 20);

var firstlevel = document.getElementById("myAudio"); 


var clicks = 0;
function clickFunc(){

clicks++;
firstlevel.play();

}



var c = document.getElementById("myCanvas");
   
var ctx = c.getContext("2d");

var w = window.innerWidth;
var h = window.innerHeight;
 

window.onresize = function(event) {
w = window.innerWidth;
h = window.innerHeight;

};

var mosx = 0;
var mosy = 0;
function getCursorPosition(canvas, event) {
    const rect = canvas.getBoundingClientRect()
    mosx = event.clientX - rect.left
    mosy = event.clientY - rect.top
}

const canvas = document.querySelector('canvas')
canvas.addEventListener('mousedown', function(e) {
    gravity = gravity + 1; 
	//if (scene == 0){console.log(firstlevel.currentTime);}
	if (gravity == 2){gravity = 0;}
	scene = 1; 
    getCursorPosition(canvas, e)
})


var blockArray = [];


var block = function(x,y,w,h) {
    this.x = x;
    this.y = y;
    this.w = w;
    this.h = h;
    
};

block.prototype.draw = function() {
    ctx.fillStyle = "red";
    ctx.fillRect(this.x - drift, this.y, this.w, this.h);
	
	if (px + 30 > this.x - drift && px < this.x - drift + this.w){
		if (py >= this.y && py + 30 <= this.y + this.h){
		firstlevel.pause(); firstlevel.currentTime = 0; drift = 0; px = 300; py = 270; gravity = 1; scene = 0;
		}
	}
};


blockArray.push(new block(300,100,400,50));

blockArray.push(new block(730,200,40,100));

blockArray.push(new block(830,100,40,100));


blockArray.push(new block(930,200,40,100));

blockArray.push(new block(1030,100,40,100));

blockArray.push(new block(1130,100,40,100));

blockArray.push(new block(1230,250,40,50));

blockArray.push(new block(1270,100,40,80));

blockArray.push(new block(1330,250,40,50));

blockArray.push(new block(1420,100,40,100));

//END OF INTRO

blockArray.push(new block(1700,200,40,100));

blockArray.push(new block(1805,100,40,100));

blockArray.push(new block(1935,200,40,100));

blockArray.push(new block(2060,100,40,100));

blockArray.push(new block(2190,220,40,80));

blockArray.push(new block(2185,100,200,30));

blockArray.push(new block(2305,220,40,80));

blockArray.push(new block(2430,100,40,100));

blockArray.push(new block(2555,200,40,100));



var px = 300;
var py = 270;

var gravity = 1; 
var end = 0; 
var drift = 0; 

var speed = 5;

var scene = 0; 

function playAudio() { 
  x.play(); 
} 

function pauseAudio() { 
  x.pause(); 
} 

function move() {

if (scene == 0){


ctx.font = "80px Arial";
ctx.fillStyle = 'white';
ctx.fillText("PRESS TO PLAY", 80, 240);

gravity = -1;
}

if (scene == 1){
drift = drift + speed;

//Background Image
var bgimg = document.getElementById("grassland");

ctx.fillStyle = '#49c9e3';
ctx.fillRect(0, 0, 800, 400);

ctx.fillStyle = 'black';
ctx.fillRect(0, 300, 800, 400);

ctx.fillStyle = 'black';
ctx.fillRect(0, -300, 800, 400);

ctx.fillStyle = 'blue';
ctx.fillRect(px, py, 30, 30);


if (gravity == 1){py = py - 10;}
if (gravity == 0){py = py + 10;}

if (py + 30 > 300){py = py - 10;}

if (py < 100){py = py + 10;}


for(var i = 0; i < blockArray.length ; i++) {
        blockArray[i].draw();
}

ctx.font = "20px Arial";
ctx.fillStyle = 'white';
ctx.fillText("x: " + mosx.toFixed(0) + "," + " y: " + mosy.toFixed(0), 10, 40);
ctx.fillText(firstlevel.currentTime.toFixed(2), 10, 70);

}

}//End of FUNCTION




 //Move events
 document.onkeydown = function(e) {

  gravity = gravity + 1; 
if (gravity == 2){gravity = 0;}

console.log("Time: " + firstlevel.currentTime + "s" + " Drift: " + drift);
 
 }//End of keydown function
 
  document.onkeyup = function(e) {
  
  }




</script>


<div style='display:none'>{title}</div>
<div style='display:none'>{menu}</div>
<div style='display:none'>{content}</div>
<div style='padding: 20px; width:100%; text-align:center;'>{footer}</div>
</body>
</html>

